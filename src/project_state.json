{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Implement/improve Tiptap editor image support: base image extension (if missing), contextual resize options via CSS classes, inline captions stored in the document schema, proper spacing, and responsive mobile behaviorâ€”without adding new libraries beyond the official Tiptap Image extension.",
  "architectural_notes": [
    "Do not install new libraries; only use existing editor configuration and the official Tiptap Image extension if base image support is missing.",
    "Image resizing is via contextual menu that applies CSS classes (img-small/img-medium/img-full); no drag resizing or heavy logic.",
    "Captions are inline editable and stored within the image node schema as part of the document structure (self-contained)."
  ],
  "known_issues": [],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-update-the-existing-rich-text-editor-implementation-to-use-the-tiptap-editor-instance-keeping-the-existing-richtexteditor-component-api-and-ensure-the-official-tiptap-image-extension-is-enabled-if-it-is-not-already-present-do-not-install-any-libraries-beyond-the-official-tiptap-image-extension",
      "title": "Update the existing rich-text editor implementation to use the Tiptap editor instance (keeping the existing RichTextEditor component API) and ensure the official Tiptap Image extension is enabled if it is not already present; do not install any libraries beyond the official Tiptap Image extension.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-an-image-node-schema-that-supports-a-a-resize-preset-and-b-an-optional-caption-stored-within-the-editor-document-not-in-a-separate-database-field-with-inline-editing-of-the-caption-directly-below-the-image",
      "title": "Implement an image node schema that supports (a) a resize preset and (b) an optional caption stored within the editor document (not in a separate database field), with inline editing of the caption directly below the image.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-lightweight-contextual-image-menu-that-appears-when-the-user-clicks-selects-an-image-offering-three-preset-width-options-small-medium-full-width-selecting-an-option-applies-css-classes-only-img-small-img-medium-img-full-do-not-implement-drag-resizing",
      "title": "Add a lightweight contextual image menu that appears when the user clicks/selects an image, offering three preset width options: Small, Medium, Full Width. Selecting an option applies CSS classes only: `img-small`, `img-medium`, `img-full`. Do not implement drag resizing.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-images-have-proper-spacing-above-and-below-and-implement-responsive-mobile-behavior-so-images-render-cleanly-on-narrow-screens-lightweight-css-based-solution-no-heavy-runtime-layout-logic",
      "title": "Ensure images have proper spacing above and below, and implement responsive mobile behavior so images render cleanly on narrow screens (lightweight CSS-based solution; no heavy runtime layout logic).",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-update-html-sanitization-used-for-rendering-stored-rich-text-so-that-the-image-sizing-classes-and-caption-markup-produced-by-the-editor-are-preserved-while-still-sanitizing-unsafe-tags-attributes",
      "title": "Update HTML sanitization used for rendering stored rich-text so that the image sizing classes and caption markup produced by the editor are preserved (while still sanitizing unsafe tags/attributes).",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Add/ensure base Tiptap Image extension exists (minimal implementation) using only the official Tiptap Image extension (no additional libraries).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Implement contextual image menu on image click with resize options (Small/Medium/Full Width) applying CSS classes (img-small/img-medium/img-full); no drag resizing.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Add inline editable image captions stored within the image node schema and saved as part of the editor document (no separate DB field).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Add proper spacing above/below images and responsive mobile behavior for images (lightweight, via existing editor configuration/CSS).",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "projectName": "Improve Tiptap editor image node: resize presets, inline captions, spacing, and mobile responsiveness",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}